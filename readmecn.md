# CleanGuard

???????????????? .NET Framework 4.6.2 + WinForms + SQLite ????????????????????????????????

## ????

### ?????FrmMain?

| ?? | ?? |
|------|------|
| ???? | ????????????? 1F/2F ????? |
| ???? | ????????????????????????? |
| ???? | ?????????????????????? |
| ???? | ????????????????? |
| ???? | ??????????????????? |
| ???? | ?? / ????? / ?????? |

### ?????FrmEditor?

- ????????????????????Tab ??????
- ???????????/?????????????/?????????
- ???????CSV ?????????????????
- ??????????T_SystemConfig ????

### ?????Printer?

- ?????????????????????????
- ???????/??/?? + ?????? + ????QRCoder ???????????
- ????????????????????????????
- ???????/??/????????????

### ?????FrmImport + ImportHelper?

- CSV / XLSX ???????????
- XLSX ??????? SharpZipLib ????? CSV
- ???????/????????????? 20 ?????????
- ???????????????????????
- ??????CG-IMP-001 ~ CG-IMP-012????????????????

### ????

| ?? | ?? |
|------|------|
| ?????FrmLockerManage? | ???/??/?????????????????? |
| ??????FrmLockerChart? | ???? + ??????? 10 ????+ ????????? PNG |
| ?????FrmLockerTrend? | ?? T_LockerSnapshot ???????? |

### ?????FrmProcessManage?

- ????????????????????
- CSV/TXT ????
- ?????FrmProcessAudit??????/??/???????????CSV ??

### ?????FrmSystemLog?

- ????Import / Backup / Print / Employee???? CSV ??
- ??????????

### ?????

- **????**?????? CleanGuard.db ? Backup/ ??????? 7 ?????
- **??????**?ThreadException + UnhandledException + ???? try-catch
- **???????**?CREATE TABLE IF NOT EXISTS + EnsureColumnExists

## ???

| ? | ?? |
|----|------|
| ?? | .NET Framework 4.6.2, Windows Forms |
| ??? | SQLite (System.Data.SQLite 1.0.119.0) |
| Excel | NPOI 2.5.6 |
| ?? | SharpZipLib 1.4.2?NPOI ???????? CSV? |
| ??? | QRCoder????????? |
| ?? | System.Windows.Forms.DataVisualization |
| ?? | ?? GB2312 ???????PinYin.cs? |
| ???? | x86??? ARM64 Windows? |

## ???

| ? | ?? |
|----|------|
| T_Employee | ???????????????????????? |
| T_Emp_Items | ??????????????????????????? |
| T_Lockers | ??????????????????????? |
| T_Process | ???? |
| T_SystemLog | ???? |
| T_SystemConfig | ????????????????? |
| T_LockerSnapshot | ?????????????? |

????? 1F/2F ? 60 ?? + 60 ???6 ??????

## ????

```text
Src/CleanGuard_App/
  Program.cs                  # ?????????????????????????
  Forms/
    FrmMain.cs                # ?????????????????????
    FrmEditor.cs              # ????????? + ?? + ???? Tab ?
    FrmImport.cs              # ??????????????????????
    FrmLockerChart.cs         # ???????? + ??? + ????
    FrmLockerTrend.cs         # ????????
    FrmLockerManage.cs        # ???????????????
    FrmProcessManage.cs       # ???????? + ????
    FrmProcessAudit.cs        # ?????????????
    FrmSystemLog.cs           # ????
  Utils/
    SQLiteHelper.cs           # ?????
    ImportHelper.cs           # CSV/XLSX ??????
    Printer.cs                # ??????
    PinYin.cs                 # ???????
    UiTheme.cs                # UI ??
Src/Database/
  init.sql                    # ???????
Output/                       # ????
```

## ?????

### ????

- Windows 7 ????.NET Framework 4.6.2?
- Visual Studio 2017+ ? MSBuild 15.0+

### ??

```bash
nuget restore Src/CleanGuard_App/packages.config -PackagesDirectory packages
msbuild Src/CleanGuard_App/CleanGuard_App.csproj /t:Build /p:Configuration=Debug
```

??????? `Output/` ???

### ??

???? `Output/CleanGuard_App.exe`????????? `CleanGuard.db` ???????????????

## ????

```text
Program.Main()
  |-- ?????????ThreadException + UnhandledException?
  |-- SQLiteHelper.InitializeDatabase()
  |     |-- CREATE TABLE IF NOT EXISTS?7 ???
  |     |-- EnsureColumnExists????????
  |     |-- SeedDefaultConfig
  |     +-- CaptureLockerSnapshot("Startup")
  |-- new FrmMain() -> InitializeLayout() -> LoadEmployeeData()
  |-- Application.Run(mainForm)
  +-- FormClosing -> BackupDatabase()
```

## ???

[MIT](LICENSE)
