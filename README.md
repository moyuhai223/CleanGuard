# CleanGuard

生产部劳保与更衣柜管理系统（CG-200）初始开发骨架，基于 .NET Framework 4.6.2 + SQLite。

## 按 V4.0 文档的功能完成度

### 已完成

- WinForms 项目骨架与主流程窗体：主界面、编辑窗体、导入向导、柜位图表、系统日志窗体。
- SQLite 自动初始化：基础字典、人员主表、物品子表、系统日志表、柜位快照表。
- 四柜独立分配逻辑：支持 1F/2F 衣柜与鞋柜独立分配、保存、编辑、离职释放与复职。
- 员工检索能力：姓名 / 拼音首字母 / 工序 模糊搜索。
- 导入能力（首版）：CSV 模板下载、CSV 导入、失败明细导出、导入日志。
- 标签打印（首版）：打印预览、二维码内容拼接（优先 QRCoder，缺失时文本降级）。
- 数据分析能力：柜位占用饼图、楼层筛选、图片导出、占用趋势图。
- 运维能力：程序退出自动备份数据库并清理 7 天前旧备份。

### 未完成 / 待完善

- **Excel 批量导入仍未按文档切到 NPOI + xlsx**：当前为 CSV 导入。
- **劳保用品子表（T_Emp_Items）尚未打通业务界面与保存逻辑**：编辑窗体仅有 Tab 页占位。
- **标签打印尚未直接输出到真实打印机流程**：当前以打印预览为主。
- **热力图展示仍为基础图表版本**：尚未实现更细粒度的“区域热力块”可视化。
- **工序字典维护后台未落地**：当前仅支持读取初始化工序并在编辑时手动输入。

## 目录

- `Src/CleanGuard_App`：主程序代码
- `Src/Database/init.sql`：数据库初始化脚本
- `Doc`：文档（预留）

## 下一步建议

1. 将导入能力升级为 NPOI xlsx，并保留失败原因导出。
2. 完成劳保用品（无尘服/鞋类/帽子）在编辑窗体中的可编辑与 `T_Emp_Items` 持久化。
3. 增加字典维护页（工序、柜位异常状态）与更完整的打印机直打配置。
