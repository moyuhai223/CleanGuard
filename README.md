# CleanGuard

生产部劳保与更衣柜管理系统（CG-200）初始开发骨架，基于 .NET Framework 4.6.2 + SQLite。

## 按 V4.0 文档的功能完成度

### 已完成

- WinForms 项目骨架与主流程窗体：主界面、编辑窗体、导入向导、柜位图表、系统日志窗体。
- SQLite 自动初始化：基础字典、人员主表、物品子表、系统日志表、柜位快照表。
- 四柜独立分配逻辑：支持 1F/2F 衣柜与鞋柜独立分配、保存、编辑、离职释放、复职与删除释放。
- 劳保用品录入（首版）：编辑窗体支持无尘服/安全鞋/帆布鞋/洁净帽固定槽位录入并写入 `T_Emp_Items`。
- 员工检索能力：姓名 / 拼音首字母 / 工序 模糊搜索。
- 导入能力（增强）：CSV 模板/导入；支持 XLSX 模板/导入（需环境安装 NPOI），失败明细导出、导入日志。
- 标签打印（首版）：打印预览、二维码内容拼接（优先 QRCoder，缺失时文本降级）。
- 数据分析能力：柜位占用饼图、楼层筛选、图片导出、占用趋势图。
- 运维能力：程序退出自动备份数据库并清理 7 天前旧备份。

### 未完成 / 待完善

- **XLSX 依赖环境安装 NPOI**：当前已支持调用，但在未部署 NPOI 的环境会提示回退到 CSV。
- **劳保用品当前为固定槽位首版**：已支持落库与回显，但尚未提供“完全动态一对多行编辑”体验。
- **标签打印尚未直接输出到真实打印机流程**：当前以打印预览为主。
- **热力图展示仍为基础图表版本**：尚未实现更细粒度的“区域热力块”可视化。
- **工序字典维护后台未落地**：当前仅支持读取初始化工序并在编辑时手动输入。

## 目录

- `Src/CleanGuard_App`：主程序代码
- `Src/Database/init.sql`：数据库初始化脚本
- `Doc`：文档（预留）

## 下一步建议

1. 在项目中正式引入 NPOI NuGet（非反射方式）并完善 xlsx 失败明细导出。
2. 将劳保用品从“固定槽位”升级为可增删的动态一对多编辑体验（保持 `T_Emp_Items` 兼容）。
3. 增加字典维护页（工序、柜位异常状态）与更完整的打印机直打配置。
