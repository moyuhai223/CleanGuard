# CleanGuard

生产部劳保与更衣柜管理系统（CG-200）初始开发骨架，基于 .NET Framework 4.6.2 + SQLite。

## 按 V4.0 文档的功能完成度

### 已完成

- WinForms 项目骨架与主流程窗体：主界面、编辑窗体、导入向导、柜位图表、系统日志窗体。
- SQLite 自动初始化：基础字典、人员主表、物品子表、系统日志表、柜位快照表。
- 四柜独立分配逻辑：支持 1F/2F 衣柜与鞋柜独立分配、保存、编辑、离职释放、复职与删除释放。
- 劳保用品录入（升级）：编辑窗体支持无尘服/安全鞋/帆布鞋/洁净帽按类别动态增删行录入并写入 `T_Emp_Items`。
- 员工检索能力：姓名 / 拼音首字母 / 工序 模糊搜索。
- 导入能力（增强）：已正式接入 NPOI（NuGet），支持 CSV/XLSX 模板与导入、失败明细 CSV/XLSX 导出、导入日志。
- 标签打印（增强）：支持打印预览与打印机直打两种模式，二维码内容拼接（优先 QRCoder，缺失时文本降级）。
- 数据分析能力：柜位占用饼图、楼层筛选、图片导出、占用趋势图。
- 运维能力：程序退出自动备份数据库并清理 7 天前旧备份。

### 未完成 / 待完善

- **热力图展示仍为基础图表版本**：尚未实现更细粒度的“区域热力块”可视化。
- **工序字典已支持新增/删除/重命名/批量导入/审计视图**：支持员工工序联动改名、审计操作类型筛选、可选日期筛选、关键字筛选、清除筛选、结果统计、按操作类型行色标识、单条复制与 CSV 导出。
- 柜位异常状态维护：支持按楼层/类型/异常筛选柜位并维护异常备注（`T_Lockers.Remark`）。

## 目录

- `Src/CleanGuard_App`：主程序代码
- `Src/Database/init.sql`：数据库初始化脚本
- `Doc`：文档（预留）

## 下一步建议

1. 完善导入校验策略（按列级规则输出错误码/错误模板），提升批量修复效率。
2. 为劳保用品动态行补充更细致校验（类别上限规则、批量粘贴、模板导入）。
3. 扩展字典维护能力（审计导出模板化）与更完整的打印机直打配置（默认打印机、纸张/边距预设）。
